/*
 * File: js/app/controller/Category.js
 *
 * This file was generated by Sencha Architect version 2.1.0.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 4.1.x library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 4.1.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('App.controller.Categories', {
    extend: 'Ext.app.Controller',
    mixins: {
        editable: 'App.controller.mixin.EditableTree'
    },
    refs: [
        {
            ref: 'tree',
            selector: '[itemId=tree.Category]'
        },
        {
            ref: 'productGrid',
            selector: '[itemId=grid.Product]'
        }
    ],

    onLaunch: function() {
        this.formClass = 'App.view.form.Category';
        this.mixins.editable.init.call(this);
        this.getTree().getSelectionModel().on('select', function() {
            this.onCategorySelected();
        }, this);
    },

    /**
     * Show products of selected category
     */
    onCategorySelected: function() {
        var sel = this.getTree().getSelectionModel().getSelection()[0];
        var store = this.getProductGrid().getStore();
        store.getProxy().extraParams.params = { category: sel.data.id };
        store.reload();
    }

});
